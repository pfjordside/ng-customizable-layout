@if (layout$ | async; as layout) {
<div
  class="drag-container"
  id="drag-container"
  [ngStyle]="{
    'grid-template-columns': templateColumns$ | async,
    'grid-gap': layout.cardMargin
  }"
>
  @for (list of layout.lists; track listTrackBy) {
  <div
    cdkDropList
    [id]="list.containerName"
    [ngClass]="list.containerName"
    [cdkDropListData]="list.items"
    [cdkDropListDisabled]="!editing"
    (cdkDropListDropped)="drop($event)"
    [cdkDropListConnectedTo]="list.connectedTo ? list.connectedTo : ''"
    [cdkDropListDisabled]="!editing"
  >
    @for (e of list.items | withoutHidden:componentMap; track $index) {
    <div
      cdkDrag
      [cdkDragStartDelay]="(dragDelay$ | async) ?? 0"
      [ngClass]="{ editing: editing }"
      [ngStyle]="{
        'margin-bottom': layout.cardMargin,
        cursor: editing ? 'grab' : 'default'
      }"
    >
      <ng-template
        *ngComponentOutlet="componentMap[e.componentName].component; injector: componentInjector"
      ></ng-template>
    </div>
    }
  </div>
  }
</div>
}
